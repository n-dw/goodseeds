{% if currentUser %}
    {% redirect 'shop/checkout/addresses' %}
{% endif %}
{% import "shop/macros/errors.html" as errList %}
{% extends 'shop/_layouts/checkout' %}

{% block content %}
    <div class="checkout-first">
        {% if not currentUser %}
            <div class="form-filter-wrapper">
                <h5 class="form-filter-toggle is-black" @click="toggleFilters"><i :class="icon"></i>Sign In</h5>
                <form method="post" class="login-form" :class="formState + ' is-black'" accept-charset="UTF-8">
                    {{ getCsrfInput() }}
                    <input type="hidden" name="action" value="users/login">
                    <input type="hidden" name="redirect" value="shop/checkout/addresses">

                    <div class="row">
                        <div class="input-wrapper col-xs-12 c-fieldset">
                            <h3>Enter your email address</h3>
                            <input class="login-form__login-email c-input {% if message is defined and message.getErrors('loginName') is not empty %}error{% endif %}"
                                   aria-label="Email" placeholder="Email *" required id="loginName" type="email" name="loginName"
                                   value="{{ craft.session.rememberedUsername }}">
                        </div>
                        <div class="input-wrapper u-pos-rel col-xs-12 c-fieldset">
                            <input class="login-form__login-password c-input {% if message is defined and message.getErrors('password') is not empty %}error{% endif %}"
                                   aria-label="Password" id="password" type="password" placeholder="Password"
                                   :type="pToggle" v-model="password" name="password">
                            <button type="button" class="pwd-toggle" @click.self.prevent="togglePassword">Show</button>
                            {{ message is defined and message ? errList.errorList(message.getErrors('password')) }}
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-wrapper col-xs-12 c-fieldset">
                            <label>
                                <input class="login-form__remember" aria-label="Remember Me" checked type="checkbox"
                                       name="rememberMe" value="1">
                                Remember me
                            </label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-wrapper col-xs-12">
                            <input aria-label="Send" type="submit" class="c-button c-button--large c-button--cta-black"
                                   value="Sign In">
                        </div>
                    </div>

                </form>
            </div>
        {% endif %}
        <div class="box">
                <p>Please sign in if you already are a member of THCPOST.<br>
                If you are not a member please continue as a guest.</p>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    {% minify js %}
    <script type="text/javascript">

        var data = {
            filtersExposed: false,
            icon: 'icon-plus-1',
            formState: 'product-filters-form--closed',
            pToggle: 'password',
            password: '',
        };
        var methods = {
            toggleFilters: function() {
                this.filtersExposed = !this.filtersExposed;
                this.filtersExposed ? this.icon = "icon-minus" : this.icon = "icon-plus-1";
                this.filtersExposed ? this.formState = "product-filters-form--open" : this.formState = "product-filters-form--closed";
            },
            togglePassword(e){
                e.preventDefault();
                this.pToggle = this.pToggle === 'password' ? 'text' : 'password'
                e.target.innerText === 'Hide' ? e.target.innerText = 'Show' :  e.target.innerText = 'Hide';
            }
        };


        thcpost.vueParams.data = Object.assign(thcpost.vueParams.data, data);
        thcpost.vueParams.methods = Object.assign(thcpost.vueParams.methods, methods);
    </script>
    {% endminify %}
{% endblock %}
